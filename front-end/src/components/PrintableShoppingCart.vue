<template>
  <div>
    <header>
      <svg
        class="logo"
        xmlns="http://www.w3.org/2000/svg"
        version="1.0"
        width="300.000000pt"
        height="50pt"
        viewBox="0 0 300.000000 106.000000"
        preserveAspectRatio="xMidYMid meet"
      >
        <g
          transform="translate(0.000000,106.000000) scale(0.100000,-0.100000)"
          fill="#000000"
          stroke="none"
        >
          <path
            d="M1635 1000 c-51 -32 -53 -36 -60 -127 -4 -48 -9 -96 -12 -107 -3 -12 -1 -16 6 -12 12 8 15 -24 5 -73 -10 -48 -27 -38 -19 12 7 41 7 42 -12 25 -30 -27 -40 -22 -62 28 -19 43 -22 45 -57 42 l-36 -3 -3 -96 c-14 -334 -106 -596 -221 -625 -127 -32 -155 177 -40 299 52 56 106 20 106 -70 0 -43 13 -57 24 -27 8 21 -3 81 -21 116 -7 15 -27 35 -44 44 -29 14 -35 14 -74 0 -52 -20 -78 -47 -105 -109 -43 -96 -21 -213 49 -261 29 -21 49 -26 95 -26 71 0 114 19 162 72 72 80 118 221 144 446 7 57 14 101 16 99 2 -2 18 -53 35 -113 39 -136 62 -184 90 -184 35 0 46 52 58 275 6 116 14 229 17 253 9 69 -39 45 -51 -27 -3 -22 -15 -47 -25 -56 -17 -15 -17 -14 -13 32 11 131 12 132 53 153 41 21 60 40 38 39 -7 0 -26 -9 -43 -19z"
          />
          <path
            d="M254 941 c-110 -28 -163 -150 -93 -217 16 -16 87 -58 157 -94 118 -61 127 -67 130 -96 2 -25 -3 -37 -30 -59 -31 -26 -36 -27 -113 -23 -55 3 -93 11 -121 26 -42 22 -104 83 -104 105 -1 28 -40 -38 -40 -68 0 -45 30 -79 105 -116 81 -40 175 -50 237 -25 63 24 101 82 102 155 1 78 -18 100 -146 166 -167 86 -202 127 -138 160 63 33 204 11 262 -41 15 -14 18 -13 33 10 9 13 15 37 13 53 -2 23 -11 31 -52 46 -57 21 -157 30 -202 18z"
          />
          <path
            d="M2010 944 c-72 -26 -93 -41 -116 -79 -54 -92 -24 -137 145 -222 144 -72 166 -90 157 -127 -10 -42 -60 -66 -137 -66 -85 0 -181 45 -218 102 -13 21 -28 35 -32 32 -5 -3 -14 -23 -20 -45 -11 -35 -10 -43 8 -67 75 -101 279 -145 366 -79 49 37 70 88 65 153 -6 72 -25 90 -164 160 -127 64 -165 95 -148 122 18 29 56 42 122 42 68 0 123 -18 160 -53 l23 -22 20 25 c11 14 18 37 17 54 -3 24 -11 31 -53 47 -50 20 -167 34 -195 23z"
          />
          <path
            d="M1012 925 c-36 -16 -35 -32 5 -67 52 -48 205 -85 300 -73 l53 6 -14 27 c-21 41 -66 78 -119 101 -58 25 -174 28 -225 6z m243 -64 c33 -16 69 -36 80 -46 19 -16 19 -16 -10 -10 -37 8 -195 81 -195 91 0 12 63 -6 125 -35z"
          />
          <path
            d="M1445 909 c-26 -13 -65 -70 -64 -95 0 -18 1 -18 9 1 5 11 19 31 31 45 l21 25 -21 -37 c-26 -49 -13 -48 39 0 58 56 49 92 -15 61z"
          />
          <path
            d="M760 855 c-13 -13 -39 -30 -59 -36 -45 -14 -64 -36 -51 -59 27 -50 106 -7 129 70 15 52 11 57 -19 25z"
          />
          <path
            d="M832 798 c-27 -35 -148 -348 -177 -457 -22 -85 -20 -153 5 -176 16 -14 20 -15 24 -4 3 8 21 72 41 144 19 72 49 158 65 192 32 70 100 159 145 192 29 21 30 21 33 2 7 -44 -90 -219 -138 -249 -46 -28 17 -45 68 -18 71 37 129 134 139 231 5 49 4 54 -21 70 -37 24 -71 13 -128 -45 -54 -53 -56 -39 -7 43 35 58 36 65 3 77 -33 13 -40 13 -52 -2z"
          />
          <path
            d="M2751 768 c-38 -77 -142 -361 -162 -443 -21 -87 -17 -134 11 -160 18 -16 19 -15 30 27 57 223 102 338 157 407 44 55 103 111 116 111 32 0 -54 -184 -115 -247 -35 -35 -39 -43 -25 -49 43 -16 120 30 163 97 30 48 58 152 50 185 -8 30 -40 48 -73 39 -14 -3 -47 -26 -74 -52 -27 -25 -49 -42 -49 -38 0 5 16 37 35 72 19 35 35 65 35 67 0 4 -59 26 -70 26 -4 0 -17 -19 -29 -42z"
          />
          <path
            d="M2388 732 c-47 -50 -108 -193 -108 -254 0 -28 6 -42 26 -57 15 -12 35 -21 44 -21 17 0 57 39 92 90 l17 25 0 -23 c1 -34 18 -60 51 -77 16 -8 30 -15 32 -15 2 0 3 30 3 68 1 58 7 79 43 156 23 49 41 91 39 93 -3 2 -19 8 -36 13 -29 8 -33 6 -56 -28 -13 -20 -27 -48 -30 -63 -3 -14 -36 -65 -73 -115 -66 -87 -67 -88 -70 -57 -4 36 43 155 88 226 31 49 30 51 -11 60 -20 5 -31 0 -51 -21z"
          />
          <path
            d="M607 702 c-27 -31 -38 -62 -53 -145 -18 -106 -18 -113 6 -137 26 -26 40 -25 40 3 0 31 53 187 75 220 19 30 15 41 -24 62 -26 13 -30 13 -44 -3z"
          />
        </g>
      </svg>
      <p class="text-caption mb-3">
        <strong>Phone: </strong> 01765553555 <br>
        Girls School Road, Chhatak, Sunamganj
      </p>

      <h2>Order# {{ orderId }}</h2>
    </header>
    <main>
      <v-table>
        <thead>
          <tr>
            <td>Item</td>
            <td class="text-right">Cost</td>
          </tr>
        </thead>
        <tbody>
          <tr v-for="cartItem in filteredCartItems" :key="cartItem.id">
            <td>
              <p class="text-body-1">{{ cartItem.name }} x{{ cartItem.quantity }}</p>
              <p class="text-caption">
                {{ formatCurrency(cartItem.price) }}
              </p>
            </td>
            <td class="text-right total-column">
              {{ formatCurrency(cartItem.price * cartItem.quantity) }}
            </td>
          </tr>
        </tbody>
      </v-table>

      <v-divider></v-divider>

      <v-table class="receipt-summary mt-5">
        <tbody>
          <tr>
            <td>Total Payable</td>
            <td><strong>{{ formatCurrency(subtotal) }}</strong></td>
          </tr>
          <tr v-if="discountTotal > 0">
            <td>Discount</td>
            <td>{{ formatCurrency(discountTotal) }}</td>
          </tr>
          <tr v-if="payment">
            <td>Payment</td>
            <td>{{ formatCurrency(payment) }}</td>
          </tr>
          <tr v-if="payment">
            <td>Remaining</td>
            <td>{{ formatCurrency(remainingAmount) }}</td>
          </tr>
          <tr v-if="coupons.length > 0">
            <td>Coupon</td>
            <td>
              <span v-for="coupon in coupons" :key="coupon.id">
                {{ coupon.code }} <br />
              </span>
            </td>
          </tr>
        </tbody>
      </v-table>

      <div class="wifi-password">
        <p>Your WIFI password is:</p>
        <p class="text-h5">{{ wifiPassword }}</p>
      </div>
    </main>
  </div>
</template>

<script>
import { mapActions, mapState } from "pinia";
import { useCartStore } from "../stores/cart";

export default {
  data: () => ({
    currency: "à§³",
    coupon: {
      name: "FOO",
      type: "percent",
      amount: 0,
    },
  }),
  computed: {
    ...mapState(useCartStore, [
      "items",
      "customer",
      "orderId",
      "payment",
      "subtotal",
      "remainingAmount",
      "customerNote",
      "coupons",
      "discountTotal",
      "wifiPassword",
    ]),

    filteredCartItems() {
      return Object.values(this.items).filter((item) => item.quantity > 0);
    },

    formattedDiscount() {
      if (this.discount.type === "percent") {
        return this.discount.value + "%";
      } else {
        return this.currency + this.discount.value;
      }
    },
    couponDiscount() {
      if (this.coupon.type === "percent") {
        return this.subtotal * (this.coupon.amount / 100);
      } else {
        return this.coupon.amount;
      }
    },
  },
  methods: {
    ...mapActions(useCartStore, ["removeCoupon"]),

    formatCurrency(amount) {
      return amount.toFixed(0);
    },
  },
};
</script>

<style scoped>
* {
  color: black !important;
}
.logo {
  max-width: 70%;
}
header {
  text-align: center;
}

.receipt-summary td:nth-child(2) {
  text-align: right;
}

.wifi-password {
  text-align: center;
  border: 1px double black;
  padding: 10pt;
}
</style>
